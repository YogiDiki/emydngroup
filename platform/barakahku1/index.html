<!DOCTYPE html>
<html lang="id" x-data="app" class="h-full">
<head>
<!-- CRITICAL: PWA Fullscreen Meta Tags -->
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />

<!-- Theme colors -->
<meta name="theme-color" content="#7c1d1d" />
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1a1a1a" />

<!-- Apple PWA -->
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="BarakahKu" />

<!-- Android PWA -->
<meta name="mobile-web-app-capable" content="yes" />

<!-- Disable auto-detection -->
<meta name="format-detection" content="telephone=no" />
  
  <title>BarakahKu - Emydn Group</title>
  <link rel="manifest" href="/platform/barakahku1/manifest.json" />
  <link rel="icon" href="/platform/barakahku1/assets/icons/icon-192.png" />
  
  <!-- Apple Touch Icons -->
  <link rel="apple-touch-icon" href="/platform/barakahku1/assets/icons/icon-192.png">
  <link rel="apple-touch-startup-image" href="/platform/barakahku1/assets/icons/icon-192.png">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <style>
    /* ========================================
       FIX: PWA FULLSCREEN (Browser Header)
       ======================================== */
    
    /* Base reset untuk mencegah scroll bounce */
    html {
      height: 100%;
      overflow: hidden;
      position: fixed;
      width: 100%;
    }
    
    body {
      height: 100vh;
      height: -webkit-fill-available;
      overflow: hidden;
      overscroll-behavior: none;
      position: fixed;
      width: 100%;
      -webkit-overflow-scrolling: touch;
    }
    
    /* CRITICAL: Fullscreen mode detection & fix */
    @media (display-mode: standalone) {
      html, body {
        height: 100vh;
        height: -webkit-fill-available;
      }
    }
    
    /* iOS Safari standalone mode */
    @media (display-mode: standalone) and (-webkit-touch-callout: none) {
      body {
        padding-top: env(safe-area-inset-top);
        padding-bottom: env(safe-area-inset-bottom);
      }
    }
    
    /* Safe area support untuk notch devices */
    .safe-top {
      padding-top: env(safe-area-inset-top);
    }
    
    .safe-bottom {
      padding-bottom: env(safe-area-inset-bottom);
    }
    
    @supports(padding: max(0px)) {
      .safe-area-padding {
        padding-top: max(12px, env(safe-area-inset-top));
        padding-bottom: max(20px, env(safe-area-inset-bottom));
        padding-left: max(12px, env(safe-area-inset-left));
        padding-right: max(12px, env(safe-area-inset-right));
      }
    }
    
    /* Container harus flex untuk fullscreen proper */
    .pwa-container {
      min-height: 100vh;
      min-height: -webkit-fill-available;
      display: flex;
      flex-direction: column;
    }
    
    /* Existing styles tetap dipertahankan */
    * {
      font-family: 'Poppins', sans-serif;
    }
    
    .font-arabic { 
      font-family: 'Amiri', serif; 
      font-size: 1.875rem; 
      line-height: 2.75rem; 
      font-weight: 700;
    }
    
    .gradient-maroon {
      background: linear-gradient(135deg, #7c1d1d 0%, #991b1b 50%, #b91c1c 100%);
    }
    
    .bg-maroon {
      background-color: #7c1d1d;
    }
    
    .text-maroon {
      color: #7c1d1d;
    }
    
    .bg-cream {
      background-color: #f5f1e8;
    }
    
    .border-maroon {
      border-color: #991b1b;
    }
    
    body {
      background: linear-gradient(180deg, #f5f1e8 0%, #ebe4d1 100%);
    }
    
    .card-islamic {
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 6px -1px rgba(124, 29, 29, 0.1), 0 2px 4px -1px rgba(124, 29, 29, 0.06);
      border: 1px solid rgba(153, 27, 27, 0.1);
    }
    
    .btn-islamic {
      background: linear-gradient(135deg, #7c1d1d 0%, #991b1b 100%);
      border-radius: 12px;
      padding: 12px 24px;
      color: white;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(124, 29, 29, 0.3);
      transition: all 0.3s ease;
    }
    
    .btn-islamic:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(124, 29, 29, 0.4);
    }
    
    .islamic-pattern {
      background-image: 
        repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(124, 29, 29, 0.03) 10px, rgba(124, 29, 29, 0.03) 20px),
        repeating-linear-gradient(-45deg, transparent, transparent 10px, rgba(124, 29, 29, 0.03) 10px, rgba(124, 29, 29, 0.03) 20px);
    }
    
    .time-badge {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 4px 12px;
      color: #7c1d1d;
      font-weight: 600;
      font-size: 0.75rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    
    .nav-item-active {
      background: linear-gradient(135deg, #7c1d1d 0%, #991b1b 100%);
      color: white;
    }
    
    .nav-item {
      color: #6b7280;
    }

    .bottom-nav-safe {
      padding-bottom: env(safe-area-inset-bottom, 0px);
    }

    /* Dark Mode Styles */
    .dark {
      color-scheme: dark;
    }
    
    .dark body {
      background: linear-gradient(180deg, #1a1a1a 0%, #0a0a0a 100%);
    }
    
    .dark .bg-cream {
      background-color: #1a1a1a;
    }
    
    .dark .card-islamic {
      background: #2a2a2a;
      border-color: rgba(185, 28, 28, 0.3);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
    }
    
    .dark .text-gray-800 {
      color: #e5e5e5 !important;
    }
    
    .dark .text-gray-700 {
      color: #d4d4d4 !important;
    }
    
    .dark .text-gray-600 {
      color: #a3a3a3 !important;
    }
    
    .dark .text-gray-500 {
      color: #737373 !important;
    }
    
    .dark .bg-gray-50 {
      background-color: #3a3a3a !important;
    }
    
    .dark .bg-gray-200 {
      background-color: #404040 !important;
    }
    
    .dark .bg-green-50 {
      background-color: #1a3a2a !important;
    }
    
    .dark .border-green-600 {
      border-color: #16a34a !important;
    }
    
    .dark .text-green-900 {
      color: #86efac !important;
    }
    
    .dark nav {
      background-color: #2a2a2a !important;
      border-color: rgba(185, 28, 28, 0.2) !important;
    }

    /* Notification Status Animations */
    @keyframes pulse-success {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.8; transform: scale(1.05); }
    }
    @keyframes slide-in-up {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes bounce-bell {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(-15deg); }
      75% { transform: rotate(15deg); }
    }
    .animate-pulse-success { animation: pulse-success 2s ease-in-out infinite; }
    .animate-slide-in-up { animation: slide-in-up 0.5s ease-out; }
    .animate-bounce-bell { display: inline-block; animation: bounce-bell 0.8s ease-in-out; }
  </style>
  
  <!-- Load app.js DULU untuk register alpine:init, BARU Alpine.js -->
  <script src="/platform/barakahku1/app.js"></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
</head>
<body class="h-full">
  <div class="flex flex-col h-full max-w-lg mx-auto shadow-2xl relative pwa-container">
    <!-- Safe area untuk notch devices -->
    <div class="safe-top"></div>
    
    <!-- Header -->
    <header class="gradient-maroon text-white px-5 py-4 shadow-lg relative overflow-hidden">
      <div class="absolute inset-0 opacity-10 islamic-pattern"></div>
      
      <div class="relative z-10">
        <div class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-2">
            <div class="bg-white rounded-full p-1.5 shadow-md">
              <img src="/platform/barakahku1/assets/icons/icon-192.png" class="w-7 h-7 rounded-full">
            </div>
              
            <div>
              <h1 class="text-xl font-bold tracking-wide">BarakahKu</h1>
              <p class="text-xs opacity-90">Teman Ibadah Harian</p>
            </div>
          </div>
          <div class="flex items-center gap-2">
            <button @click="toggleDarkMode()" class="p-2 hover:bg-white/20 rounded-full transition-all" title="Toggle Dark Mode">
              <svg x-show="!darkMode" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
              </svg>
              <svg x-show="darkMode" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
              </svg>
            </button>
            <button @click="showSearch = !showSearch" class="p-2 hover:bg-white/20 rounded-full transition-all">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
              </svg>
            </button>
          </div>
        </div>
        
        <!-- Date Info -->
        <div class="bg-white/15 backdrop-blur-sm rounded-xl px-4 py-2 mb-3 border border-white/20">
          <div class="flex items-center justify-between text-sm">
            <div class="flex items-center gap-2">
              <span>ğŸ“…</span>
              <span x-text="new Date().toLocaleDateString('id-ID', {weekday: 'long', day: 'numeric', month: 'long', year: 'numeric'})"></span>
            </div>
          </div>
          <div class="text-xs opacity-90 mt-1">
            <span x-text="hijriDate"></span>
          </div>          
        </div>
        
        <!-- Prayer Times -->
        <template x-if="jadwal.Fajr">
          <div class="bg-white/15 backdrop-blur-sm rounded-xl px-4 py-3 border border-white/20">
            <div class="flex items-center justify-between text-xs mb-3">
              <div class="flex items-center gap-1.5">
                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                </svg>
                <span class="opacity-90 font-medium" x-text="cityName"></span>
              </div>
              <button @click="loadJadwal()" class="opacity-80 hover:opacity-100 underline transition">Perbarui</button>
            </div>
            <div class="grid grid-cols-5 gap-2 text-xs">
              <div class="text-center">
                <div class="opacity-80 mb-1">Subuh</div>
                <div class="time-badge" x-text="jadwal.Fajr"></div>
              </div>
              <div class="text-center">
                <div class="opacity-80 mb-1">Dzuhur</div>
                <div class="time-badge" x-text="jadwal.Dhuhr"></div>
              </div>
              <div class="text-center">
                <div class="opacity-80 mb-1">Ashar</div>
                <div class="time-badge" x-text="jadwal.Asr"></div>
              </div>
              <div class="text-center">
                <div class="opacity-80 mb-1">Maghrib</div>
                <div class="time-badge" x-text="jadwal.Maghrib"></div>
              </div>
              <div class="text-center">
                <div class="opacity-80 mb-1">Isya</div>
                <div class="time-badge" x-text="jadwal.Isha"></div>
              </div>
            </div>
          </div>
        </template>
      </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto pb-28 bg-cream safe-bottom">

      <!-- Beranda -->
      <div x-show="activeTab === 'beranda'">
        <div class="p-5 space-y-5">
          <!-- Ayat Quote -->
          <div class="card-islamic p-5 text-center islamic-pattern">
            <p class="text-gray-800 text-2xl font-arabic leading-relaxed mb-2">Ø¥ÙÙ†ÙÙ‘ Ù…ÙØ¹Ù Ø§Ù„Ù’Ø¹ÙØ³Ù’Ø±Ù ÙŠÙØ³Ù’Ø±Ù‹Ø§</p>
            <p class="text-sm text-gray-600 font-medium">Sesungguhnya bersama kesulitan ada kemudahan</p>
            <p class="text-xs text-gray-500 mt-1">QS. Al-Insyirah: 6</p>
          </div>

          <!-- Progress Bacaan Qur'an -->
          <template x-if="lastRead">
            <div class="card-islamic p-4 bg-gradient-to-r from-emerald-600 to-emerald-700 text-white">
              <div class="flex items-center justify-between mb-2">
                <div class="flex items-center gap-2">
                  <span class="text-2xl">ğŸ“–</span>
                  <div>
                    <p class="text-xs opacity-90 font-medium">Terakhir Dibaca</p>
                    <p class="text-lg font-bold" x-text="lastRead.namaLatin"></p>
                  </div>
                </div>
                <button @click="continueReading()" class="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg text-sm font-semibold transition">
                  Lanjutkan
                </button>
              </div>
              <p class="text-xs opacity-75" x-text="'Ayat ' + lastRead.ayat + ' â€¢ ' + lastRead.timestamp"></p>
            </div>
          </template>

          <!-- Mood Islami -->
          <div class="card-islamic p-4 bg-pink-100 dark:bg-pink-900/40">
            <p class="text-sm font-bold text-gray-800 dark:text-gray-100 mb-3">ğŸ’› Bagaimana perasaanmu hari ini?</p>
            
            <template x-if="!currentMood">
              <div class="grid grid-cols-5 gap-2">
                <button @click="setMood('sedih')" class="flex flex-col items-center gap-1 p-2 rounded-lg hover:bg-pink-200 dark:hover:bg-pink-800 transition">
                  <span class="text-2xl">ğŸ˜¢</span>
                  <span class="text-xs text-gray-800 dark:text-gray-200">Sedih</span>
                </button>
                <button @click="setMood('senang')" class="flex flex-col items-center gap-1 p-2 rounded-lg hover:bg-pink-200 dark:hover:bg-pink-800 transition">
                  <span class="text-2xl">ğŸ˜Š</span>
                  <span class="text-xs text-gray-800 dark:text-gray-200">Senang</span>
                </button>
                <button @click="setMood('cemas')" class="flex flex-col items-center gap-1 p-2 rounded-lg hover:bg-pink-200 dark:hover:bg-pink-800 transition">
                  <span class="text-2xl">ğŸ˜°</span>
                  <span class="text-xs text-gray-800 dark:text-gray-200">Cemas</span>
                </button>
                <button @click="setMood('syukur')" class="flex flex-col items-center gap-1 p-2 rounded-lg hover:bg-pink-200 dark:hover:bg-pink-800 transition">
                  <span class="text-2xl">ğŸ¤²</span>
                  <span class="text-xs text-gray-800 dark:text-gray-200">Syukur</span>
                </button>
                <button @click="setMood('lelah')" class="flex flex-col items-center gap-1 p-2 rounded-lg hover:bg-pink-200 dark:hover:bg-pink-800 transition">
                  <span class="text-2xl">ğŸ˜´</span>
                  <span class="text-xs text-gray-800 dark:text-gray-200">Lelah</span>
                </button>
              </div>
            </template>

            <template x-if="currentMood">
              <div class="bg-white dark:bg-pink-300 rounded-xl p-4 border-2 border-pink-300 dark:border-pink-400">
                <p class="font-arabic text-right text-gray-800 dark:text-gray-900 text-xl leading-loose mb-2" x-text="moodSuggestions[currentMood].ayat"></p>
                <p class="text-sm text-gray-700 dark:text-gray-900 mb-2" x-text="moodSuggestions[currentMood].arti"></p>
                <p class="text-xs text-gray-500 dark:text-gray-800 mb-3" x-text="moodSuggestions[currentMood].ref"></p>
                <button @click="clearMood()" class="text-xs text-red-600 hover:text-red-700 font-semibold">Tutup</button>
              </div>
            </template>
          </div>

          <!-- Quick Stats -->
          <div class="grid grid-cols-3 gap-3">
            <div class="card-islamic p-4 text-center">
              <div class="w-12 h-12 mx-auto mb-2 bg-gradient-to-br from-red-900 to-red-700 rounded-full flex items-center justify-center">
                <span class="text-2xl">ğŸ“–</span>
              </div>
              <p class="text-2xl font-bold text-maroon" x-text="quran.length"></p>
              <p class="text-xs text-gray-600 font-medium">Surah</p>
            </div>
            <div class="card-islamic p-4 text-center">
              <div class="w-12 h-12 mx-auto mb-2 bg-gradient-to-br from-red-900 to-red-700 rounded-full flex items-center justify-center">
                <span class="text-2xl">ğŸ¤²</span>
              </div>
              <p class="text-2xl font-bold text-maroon" x-text="doaList.length"></p>
              <p class="text-xs text-gray-600 font-medium">Doa</p>
            </div>
            <div class="card-islamic p-4 text-center">
              <div class="w-12 h-12 mx-auto mb-2 bg-gradient-to-br from-red-900 to-red-700 rounded-full flex items-center justify-center">
                <span class="text-2xl">ğŸµ</span>
              </div>
              <p class="text-2xl font-bold text-maroon" x-text="murotalList.length"></p>
              <p class="text-xs text-gray-600 font-medium">Murottal</p>
            </div>
          </div>

          <!-- Quick Menu -->
          <div class="space-y-3">
            <button @click="activeTab = 'quran'" class="w-full card-islamic p-4 flex items-center gap-4 transition-all hover:shadow-lg">
              <div class="w-14 h-14 bg-gradient-to-br from-red-900 to-red-700 rounded-2xl flex items-center justify-center shadow-md">
                <span class="text-3xl">ğŸ“–</span>
              </div>
              <div class="flex-1 text-left">
                <p class="font-bold text-gray-800 text-base">Baca Al-Qur'an</p>
                <p class="text-xs text-gray-500 mt-0.5">114 Surah dengan terjemahan lengkap</p>
              </div>
              <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
              </svg>
            </button>

            <button @click="activeTab = 'doa'" class="w-full card-islamic p-4 flex items-center gap-4 transition-all hover:shadow-lg">
              <div class="w-14 h-14 bg-gradient-to-br from-red-900 to-red-700 rounded-2xl flex items-center justify-center shadow-md">
                <span class="text-3xl">ğŸ¤²</span>
              </div>
              <div class="flex-1 text-left">
                <p class="font-bold text-gray-800 text-base">Doa Harian</p>
                <p class="text-xs text-gray-500 mt-0.5">Kumpulan doa sehari-hari lengkap</p>
              </div>
              <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
              </svg>
            </button>

            <button @click="activeTab = 'murottal'" class="w-full card-islamic p-4 flex items-center gap-4 transition-all hover:shadow-lg">
              <div class="w-14 h-14 bg-gradient-to-br from-red-900 to-red-700 rounded-2xl flex items-center justify-center shadow-md">
                <span class="text-3xl">ğŸµ</span>
              </div>
              <div class="flex-1 text-left">
                <p class="font-bold text-gray-800 text-base">Murottal Al-Qur'an</p>
                <p class="text-xs text-gray-500 mt-0.5">Dengarkan lantunan indah Al-Qur'an</p>
              </div>
              <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
              </svg>
            </button>

            <button @click="activeTab = 'ibadah'" class="w-full card-islamic p-4 flex items-center gap-4 transition-all hover:shadow-lg">
              <div class="w-14 h-14 bg-gradient-to-br from-red-900 to-red-700 rounded-2xl flex items-center justify-center shadow-md">
                <span class="text-3xl">âœ…</span>
              </div>
              <div class="flex-1 text-left">
                <p class="font-bold text-gray-800 text-base">Checklist Ibadah</p>
                <p class="text-xs text-gray-500 mt-0.5">Pantau dan kelola amalan harian</p>
              </div>
              <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
              </svg>
            </button>

            <button @click="activeTab = 'masjid'" class="w-full card-islamic p-4 flex items-center gap-4 transition-all hover:shadow-lg">
              <div class="w-14 h-14 bg-gradient-to-br from-red-900 to-red-700 rounded-2xl flex items-center justify-center shadow-md">
                <span class="text-3xl">ğŸ•Œ</span>
              </div>
              <div class="flex-1 text-left">
                <p class="font-bold text-gray-800 text-base">Masjid Terdekat</p>
                <p class="text-xs text-gray-500 mt-0.5">Temukan masjid di sekitarmu</p>
              </div>
              <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
              </svg>
            </button>
          </div>

          <!-- Install Button -->
          <button @click="installApp()" class="w-full btn-islamic flex items-center justify-center gap-2">
            <span>ğŸ“²</span>
            <span>Install Aplikasi di Perangkat</span>
          </button>

          <button 
            @click="requestNotificationPermission()" 
            class="w-full flex items-center justify-center gap-2 rounded-xl px-6 py-3 font-semibold shadow-lg hover:shadow-xl transition-all hover:scale-[1.02]"
            :class="[
              notificationStatus === 'active' ? 'bg-gradient-to-r from-green-600 to-green-700 text-white animate-pulse-success' : 
              notificationStatus === 'denied' ? 'bg-gradient-to-r from-gray-500 to-gray-600 text-white' : 
              'bg-gradient-to-r from-amber-600 to-amber-700 text-white'
            ]"
          >
            <template x-if="notificationStatus === 'active'">
              <span class="text-xl">âœ…</span>
            </template>
            <template x-if="notificationStatus === 'denied'">
              <span class="text-xl">ğŸ”•</span>
            </template>
            <template x-if="notificationStatus === 'inactive'">
              <span class="text-xl animate-bounce-bell">ğŸ””</span>
            </template>
            <span x-text="notificationStatus === 'active' ? 'Notifikasi Aktif' : notificationStatus === 'denied' ? 'Notifikasi Diblokir' : 'Aktifkan Notifikasi'"></span>
          </button>

          <template x-if="notificationStatus === 'active'">
            <div class="animate-slide-in-up card-islamic p-3 bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-l-4 border-green-600">
              <div class="flex items-start gap-2">
                <span class="text-lg mt-0.5">âœ…</span>
                <div>
                  <p class="text-sm font-bold text-green-800 dark:text-green-400">Notifikasi sudah aktif!</p>
                  <p class="text-xs text-green-700 dark:text-green-500 mt-0.5">ğŸ”” Anda akan menerima notifikasi dari BarakahKu</p>
                </div>
              </div>
            </div>
          </template>
          <template x-if="notificationStatus === 'denied'">
            <div class="animate-slide-in-up card-islamic p-3 bg-gray-50 dark:bg-gray-800 border-l-4 border-gray-400">
              <div class="flex items-start gap-2">
                <span class="text-lg mt-0.5">â„¹ï¸</span>
                <div>
                  <p class="text-xs text-gray-600 dark:text-gray-400">Aktifkan notifikasi di Settings browser untuk menerima pengingat</p>
                </div>
              </div>
            </div>
          </template>
        </div>
      </div>

      <!-- Qur'an -->
      <div x-show="activeTab === 'quran'">
        <div class="p-5">
          <template x-if="!currentSurah">
            <div class="space-y-3">
              <div class="card-islamic p-4 bg-gradient-to-br from-red-900 to-red-700 text-white">
                <p class="text-sm opacity-90 font-medium">Al-Qur'an Digital</p>
                <p class="text-2xl font-bold mt-1">114 Surah Lengkap</p>
              </div>
              
              <template x-for="surah in quran" :key="surah.nomor">
                <div @click="loadSurah(surah.nomor)" class="card-islamic p-4 hover:shadow-lg transition-all cursor-pointer">
                  <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-gradient-to-br from-red-900 to-red-700 text-white font-bold rounded-xl flex items-center justify-center text-base shadow-md shrink-0">
                      <span x-text="surah.nomor"></span>
                    </div>
                    <div class="flex-1 min-w-0">
                      <h3 class="font-bold text-gray-800 text-base mb-0.5" x-text="surah.namaLatin"></h3>
                      <p class="text-xs text-gray-500" x-text="surah.arti + ' â€¢ ' + surah.jumlahAyat + ' Ayat'"></p>
                    </div>
                    <svg class="w-5 h-5 text-gray-400 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                  </div>
                </div>
              </template>
            </div>
          </template>

          <template x-if="currentSurah">
            <div class="space-y-4">
              <button @click="currentSurah = null" class="flex items-center gap-2 text-red-900 hover:text-red-700 font-semibold">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                </svg>
                Kembali ke Daftar Surah
              </button>

              <div class="card-islamic p-5 bg-gradient-to-br from-red-900 to-red-700 text-white text-center">
                <h2 class="text-2xl font-bold" x-text="currentSurah.namaLatin"></h2>
                <p class="text-sm opacity-90 mt-1" x-text="currentSurah.ayat.length + ' Ayat'"></p>
              </div>

              <template x-for="ayat in currentSurah.ayat" :key="ayat.nomorAyat">
                <div class="card-islamic p-5">
                  <div class="flex items-center justify-between mb-4">
                    <div class="w-9 h-9 bg-gradient-to-br from-red-900 to-red-700 text-white font-bold rounded-lg flex items-center justify-center text-sm shadow">
                      <span x-text="ayat.nomorAyat"></span>
                    </div>
                    <button @click="bookmarkAyat(ayat.nomorAyat)" class="text-sm text-red-900 hover:text-red-700 font-medium flex items-center gap-1.5 transition">
                      <span>ğŸ”–</span> Simpan Ayat
                    </button>
                  </div>
                  <p class="font-arabic text-right text-gray-800 leading-loose mb-4" x-text="ayat.arab"></p>
                  <p class="text-sm text-gray-600 italic mb-3 leading-relaxed" x-text="ayat.latin"></p>
                  <p class="text-sm text-gray-700 leading-relaxed" x-text="ayat.teks"></p>
                </div>
              </template>
            </div>
          </template>
        </div>
      </div>

<!-- Doa -->
<div x-show="activeTab === 'doa'">
  <div class="p-5">
    
    <!-- ========================= -->
    <!-- ğŸ“‚ PILIH KATEGORI DOA -->
    <!-- ========================= -->
    <template x-if="!selectedDoaCategory && !currentDoa">
      <div class="space-y-3">
        <div class="card-islamic p-4 bg-gradient-to-br from-red-900 to-red-700 text-white">
          <p class="text-sm opacity-90 font-medium">Doa & Dzikir</p>
          <p class="text-2xl font-bold mt-1">Pilih Kategori</p>
        </div>

        <template x-for="category in doaCategories" :key="category.id">
          <div 
            @click="selectDoaCategory(category)" 
            class="card-islamic p-4 hover:shadow-lg transition-all cursor-pointer"
          >
            <div class="flex items-center gap-4">
              <div class="w-14 h-14 bg-gradient-to-br from-red-900 to-red-700 text-white rounded-xl flex items-center justify-center text-2xl shadow-md shrink-0">
                <span x-text="category.icon"></span>
              </div>
              <div class="flex-1 min-w-0">
                <h3 class="font-bold text-gray-800 text-base mb-1" x-text="category.name"></h3>
                <p class="text-xs text-gray-500" x-text="category.description"></p>
              </div>
              <svg 
                class="w-5 h-5 text-gray-400 shrink-0" 
                fill="none" 
                stroke="currentColor" 
                viewBox="0 0 24 24"
              >
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
              </svg>
            </div>
          </div>
        </template>
      </div>
    </template>

    <!-- ========================= -->
    <!-- ğŸ“œ DAFTAR DOA (per kategori) -->
    <!-- ========================= -->
    <template x-if="selectedDoaCategory && !currentDoa">
      <div class="space-y-3">
        <button 
          @click="selectedDoaCategory = null" 
          class="flex items-center gap-2 text-red-900 hover:text-red-700 font-semibold mb-2"
        >
          <svg 
            class="w-5 h-5" 
            fill="none" 
            stroke="currentColor" 
            viewBox="0 0 24 24"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
          Kembali ke Kategori
        </button>

        <div class="card-islamic p-4 bg-gradient-to-br from-red-900 to-red-700 text-white">
          <div class="flex items-center gap-3">
            <span class="text-3xl" x-text="selectedDoaCategory.icon"></span>
            <div>
              <p class="text-sm opacity-90 font-medium" x-text="selectedDoaCategory.name"></p>
              <p class="text-lg font-bold mt-0.5" x-text="filteredDoaList.length + ' Doa'"></p>
            </div>
          </div>
        </div>

        <template x-for="doa in filteredDoaList" :key="doa.id">
          <div 
            @click="currentDoa = doa" 
            class="card-islamic p-4 hover:shadow-lg transition-all cursor-pointer"
          >
            <div class="flex items-center gap-4">
              <div class="w-10 h-10 bg-gradient-to-br from-red-900 to-red-700 text-white font-bold rounded-lg flex items-center justify-center text-sm shadow-md shrink-0">
                <span x-text="doa.id"></span>
              </div>
              <div class="flex-1 min-w-0">
                <h3 class="font-bold text-gray-800 text-base" x-text="doa.judul"></h3>
              </div>
              <svg 
                class="w-5 h-5 text-gray-400 shrink-0" 
                fill="none" 
                stroke="currentColor" 
                viewBox="0 0 24 24"
              >
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
              </svg>
            </div>
          </div>
        </template>
      </div>
    </template>

    <!-- ========================= -->
    <!-- ğŸ“– DETAIL DOA -->
    <!-- ========================= -->
    <template x-if="currentDoa">
      <div class="space-y-4">
        <button 
          @click="backFromDoaDetail()" 
          class="flex items-center gap-2 text-red-900 hover:text-red-700 font-semibold"
        >
          <svg 
            class="w-5 h-5" 
            fill="none" 
            stroke="currentColor" 
            viewBox="0 0 24 24"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
          Kembali ke Daftar Doa
        </button>

        <div class="card-islamic p-5 bg-gradient-to-br from-red-900 to-red-700 text-white text-center">
          <h2 class="text-xl font-bold" x-text="currentDoa.judul"></h2>
        </div>

        <div class="card-islamic p-5">
          <p 
            class="font-arabic text-right text-gray-800 leading-loose mb-4 text-3xl" 
            x-text="currentDoa.arab"
          ></p>

          <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-3">
            <p 
              class="text-sm text-gray-600 dark:text-gray-300 italic leading-relaxed" 
              x-text="currentDoa.latin"
            ></p>
          </div>

          <div class="bg-green-50 dark:bg-green-900/30 border-l-4 border-green-600 rounded-lg p-4">
            <p class="text-sm font-semibold text-green-900 dark:text-green-300 mb-1">Artinya:</p>
            <p 
              class="text-sm text-gray-800 dark:text-gray-200 leading-relaxed mb-2" 
              x-text="currentDoa.terjemah"
            ></p>

            <template x-if="currentDoa.sumber">
              <p 
                class="text-xs text-gray-600 dark:text-gray-400 mt-2 italic" 
                x-text="'ğŸ“– ' + currentDoa.sumber"
              ></p>
            </template>
          </div>
        </div>
      </div>
    </template>
  </div>
</div>


      <!-- Murottal -->
      <div x-show="activeTab === 'murottal'">
        <div class="p-5 space-y-3">
          <div class="card-islamic p-4 bg-gradient-to-br from-red-900 to-red-700 text-white">
            <p class="text-sm opacity-90 font-medium">Murottal Al-Qur'an</p>
            <p class="text-2xl font-bold mt-1">Dengarkan Lantunan Indah</p>
            <p class="text-xs opacity-75 mt-2">Audio loading saat diputar pertama kali</p>
          </div>

          <template x-if="murotalList.length === 0">
            <div class="text-center py-12">
              <div class="inline-block animate-spin rounded-full h-10 w-10 border-4 border-red-900 border-t-transparent mb-3"></div>
              <p class="text-sm text-gray-600">Memuat daftar murottal...</p>
            </div>
          </template>

          <template x-for="murottal in murotalList" :key="'murottal-' + murottal.nomor">
            <div class="card-islamic p-4">
              <div class="flex items-center gap-3 mb-3">
                <div class="w-12 h-12 bg-gradient-to-br from-red-900 to-red-700 text-white font-bold rounded-xl flex items-center justify-center text-base shadow-md shrink-0">
                  <span x-text="murottal.nomor"></span>
                </div>
                <div class="flex-1 min-w-0">
                  <h3 class="font-bold text-gray-800 text-sm mb-0.5" x-text="murottal.judul"></h3>
                  <p class="text-xs text-gray-500" x-text="murottal.qari"></p>
                </div>
              </div>
              <template x-if="murottal.audio">
                <audio controls class="w-full h-10" :src="murottal.audio" controlsList="nodownload" preload="auto" style="filter: sepia(0.5) hue-rotate(-30deg);"></audio>
              </template>
              <template x-if="!murottal.audio">
                <p class="text-xs text-red-600 bg-red-50 rounded-lg p-2">Audio tidak tersedia</p>
              </template>
            </div>
          </template>
        </div>
      </div>

      <!-- Ibadah Checklist -->
      <div x-show="activeTab === 'ibadah'">
        <div class="p-5">
          <div class="card-islamic p-4 bg-gradient-to-br from-red-900 to-red-700 text-white mb-4">
            <p class="text-sm opacity-90 font-medium">Checklist Ibadah Hari Ini</p>
            <p class="text-base font-bold mt-1" x-text="new Date().toLocaleDateString('id-ID', {weekday: 'long', day: 'numeric', month: 'long', year: 'numeric'})"></p>
          </div>

          <div class="space-y-3 mb-5">
            <template x-for="item in checklist" :key="item.id">
              <label class="card-islamic p-4 flex items-center gap-3 cursor-pointer hover:shadow-lg transition-all">
                <input 
                  type="checkbox" 
                  x-model="item.done" 
                  @change="saveChecklist()"
                  class="w-6 h-6 text-red-900 rounded-lg focus:ring-2 focus:ring-red-700 shrink-0 cursor-pointer"
                />
                <div class="flex-1 min-w-0">
                  <p class="font-bold text-gray-800 text-sm mb-0.5" :class="item.done ? 'line-through text-gray-400' : ''" x-text="item.name"></p>
                  <p class="text-xs text-gray-500" x-text="item.description"></p>
                </div>
                <span class="text-2xl shrink-0" x-text="item.icon"></span>
              </label>
            </template>
          </div>

          <!-- Progress -->
          <div class="card-islamic p-5">
            <p class="text-sm text-gray-700 mb-3 font-semibold">Progress Hari Ini</p>
            <div class="w-full bg-gray-200 rounded-full h-3 mb-3 overflow-hidden">
              <div 
                class="bg-gradient-to-r from-red-900 to-red-700 h-3 rounded-full transition-all duration-500"
                :style="`width: ${(checklist.filter(i => i.done).length / checklist.length * 100)}%`"
              ></div>
            </div>
            <p class="text-sm text-gray-600 text-center">
              <span class="font-bold text-red-900 text-lg" x-text="checklist.filter(i => i.done).length"></span> 
              <span class="text-gray-500">dari</span>
              <span class="font-bold text-lg" x-text="checklist.length"></span> 
              <span class="text-gray-500">amalan selesai</span>
            </p>
          </div>
        </div>
      </div>

      <!-- Masjid Terdekat -->
      <div x-show="activeTab === 'masjid'">
        <div class="p-5">
          <div class="card-islamic p-4 bg-gradient-to-br from-red-900 to-red-700 text-white mb-4">
            <p class="text-sm opacity-90 font-medium">Masjid Terdekat</p>
            <p class="text-2xl font-bold mt-1">Temukan Masjid di Sekitarmu</p>
          </div>

          <template x-if="!userCoords">
            <div class="card-islamic p-6 text-center">
              <span class="text-4xl mb-3 block">ğŸ“</span>
              <p class="text-sm text-gray-600 mb-4">Lokasi belum tersedia. Aktifkan izin lokasi dari beranda.</p>
              <button @click="loadJadwal()" class="btn-islamic inline-flex items-center gap-2">
                <span>Aktifkan Lokasi</span>
              </button>
            </div>
          </template>

          <template x-if="userCoords && nearbyMosques.length === 0 && !loadingMosques">
            <div class="card-islamic p-6 text-center">
              <span class="text-4xl mb-3 block">ğŸ•Œ</span>
              <p class="text-sm text-gray-600 mb-4">Cari masjid terdekat dari lokasimu</p>
              <button @click="findNearbyMosques()" class="btn-islamic inline-flex items-center gap-2">
                <span>Cari Masjid</span>
              </button>
            </div>
          </template>

          <template x-if="loadingMosques">
            <div class="text-center py-12">
              <div class="inline-block animate-spin rounded-full h-10 w-10 border-4 border-red-900 border-t-transparent mb-3"></div>
              <p class="text-sm text-gray-600">Mencari masjid terdekat...</p>
            </div>
          </template>

          <template x-if="nearbyMosques.length > 0">
            <div class="space-y-3">
              <div class="flex items-center justify-between mb-3">
                <p class="text-sm text-gray-600 font-medium">
                  <span class="font-bold text-red-900" x-text="nearbyMosques.length"></span> masjid ditemukan
                </p>
                <button @click="findNearbyMosques()" class="text-xs text-red-900 hover:text-red-700 font-semibold underline">
                  Refresh
                </button>
              </div>

              <template x-for="(masjid, index) in nearbyMosques" :key="'masjid-' + index">
                <div class="card-islamic p-4">
                  <div class="flex items-start gap-3 mb-2">
                    <div class="w-10 h-10 bg-gradient-to-br from-red-900 to-red-700 text-white rounded-lg flex items-center justify-center shrink-0">
                      <span class="text-xl">ğŸ•Œ</span>
                    </div>
                    <div class="flex-1 min-w-0">
                      <h3 class="font-bold text-gray-800 text-base mb-1" x-text="masjid.name"></h3>
                      <p class="text-xs text-gray-500 mb-2" x-text="masjid.address"></p>
                      <div class="flex items-center gap-2">
                        <span class="text-xs bg-red-50 dark:bg-red-900/20 text-red-900 dark:text-red-400 px-2 py-1 rounded-full font-semibold">
                          ğŸ“ <span x-text="masjid.distance + ' km'"></span>
                        </span>
                      </div>
                    </div>
                  </div>
                  <button @click="openGoogleMaps(masjid.lat, masjid.lon, masjid.name)" class="w-full mt-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-semibold py-2 rounded-lg transition">
                    ğŸ—ºï¸ Buka di Google Maps
                  </button>
                </div>
              </template>
            </div>
          </template>
        </div>
      </div>


      <!-- Search Overlay -->
<div x-show="showSearch" 
     x-transition:enter="transition ease-out duration-300"
     x-transition:enter-start="opacity-0"
     x-transition:enter-end="opacity-100"
     x-transition:leave="transition ease-in duration-200"
     x-transition:leave-start="opacity-100"
     x-transition:leave-end="opacity-0"
     class="fixed inset-0 bg-black/50 z-50 flex items-start justify-center pt-20 px-4"
     @click.self="showSearch = false"
     style="display: none;">
  
  <div class="card-islamic w-full max-w-lg p-5 animate-slide-in-up">
    <!-- Header Search -->
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-lg font-bold text-gray-800">ğŸ” Pencarian</h3>
      <button @click="showSearch = false" class="text-gray-500 hover:text-gray-700">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>
    </div>

    <!-- Search Input -->
    <div class="relative mb-4">
      <input 
        type="text" 
        x-model="searchQuery"
        @keyup="performSearch()"
        placeholder="Cari surah, doa, atau ayat..."
        class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 focus:border-red-900 focus:ring-2 focus:ring-red-900/20 outline-none transition"
        autofocus
      />
      <svg class="w-5 h-5 absolute right-4 top-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
      </svg>
    </div>

    <!-- Search Results -->
    <div class="max-h-96 overflow-y-auto space-y-2">
      <template x-if="!searchQuery || searchQuery.length < 2">
        <div class="text-center py-8 text-gray-500">
          <svg class="w-12 h-12 mx-auto mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
          </svg>
          <p class="text-sm">Ketik minimal 2 karakter untuk mencari</p>
        </div>
      </template>

      <template x-if="searchQuery && searchQuery.length >= 2 && searchResults.length === 0">
        <div class="text-center py-8 text-gray-500">
          <span class="text-4xl mb-2 block">ğŸ”</span>
          <p class="text-sm">Tidak ada hasil untuk "<span x-text="searchQuery"></span>"</p>
        </div>
      </template>

      <template x-if="searchResults.length > 0">
        <div>
          <p class="text-xs text-gray-500 mb-3">
            Ditemukan <span class="font-bold text-red-900" x-text="searchResults.length"></span> hasil
          </p>

          <template x-for="result in searchResults.slice(0, 10)" :key="result.id">
            <div 
              @click="openSearchResult(result)"
              class="p-3 bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-lg cursor-pointer transition-all mb-2"
            >
              <div class="flex items-start gap-3">
                <span class="text-xl shrink-0" x-text="result.icon"></span>
                <div class="flex-1 min-w-0">
                  <p class="text-sm font-bold text-gray-800 dark:text-gray-100 mb-1" x-text="result.title"></p>
                  <p class="text-xs text-gray-600 dark:text-gray-300 line-clamp-2" x-text="result.description"></p>
                  <span class="inline-block mt-1 text-xs bg-red-100 dark:bg-red-900/30 text-red-900 dark:text-red-400 px-2 py-0.5 rounded-full" x-text="result.type"></span>
                </div>
              </div>
            </div>
          </template>
        </div>
      </template>
    </div>
  </div>
</div>

    </main>

    <!-- Bottom Navigation -->
    <nav class="bg-white border-t-2 border-red-900/10 px-2 py-2 fixed bottom-0 left-0 right-0 max-w-lg mx-auto shadow-2xl bottom-nav-safe z-50 safe-bottom">
      <div class="grid grid-cols-5 gap-1">
      
        <!-- Beranda -->
        <button @click="activeTab = 'beranda'"
                class="flex flex-col items-center justify-center gap-0.5 py-2 px-2 rounded-xl transition-all"
                :class="activeTab === 'beranda' ? 'nav-item-active scale-105' : 'nav-item'">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/>
          </svg>
          <span class="text-[10px] font-semibold leading-tight">Beranda</span>
        </button>
    
        <!-- Quran -->
        <button @click="activeTab = 'quran'"
                class="flex flex-col items-center justify-center gap-0.5 py-2 px-2 rounded-xl transition-all"
                :class="activeTab === 'quran' ? 'nav-item-active scale-105' : 'nav-item'">
          <span class="text-xl">ğŸ“–</span>
          <span class="text-[10px] font-semibold leading-tight">Qur'an</span>
        </button>
    
        <!-- Doa -->
        <button @click="activeTab = 'doa'"
                class="flex flex-col items-center justify-center gap-0.5 py-2 px-2 rounded-xl transition-all"
                :class="activeTab === 'doa' ? 'nav-item-active scale-105' : 'nav-item'">
          <span class="text-xl">ğŸ¤²</span>
          <span class="text-[10px] font-semibold leading-tight">Doa</span>
        </button>
    
        <!-- Murottal -->
        <button @click="activeTab = 'murottal'"
                class="flex flex-col items-center justify-center gap-0.5 py-2 px-2 rounded-xl transition-all"
                :class="activeTab === 'murottal' ? 'nav-item-active scale-105' : 'nav-item'">
          <span class="text-xl">ğŸµ</span>
          <span class="text-[10px] font-semibold leading-tight">Murottal</span>
        </button>
    
        <!-- Checklist -->
        <button @click="activeTab = 'ibadah'"
                class="flex flex-col items-center justify-center gap-0.5 py-2 px-2 rounded-xl transition-all"
                :class="activeTab === 'ibadah' ? 'nav-item-active scale-105' : 'nav-item'">
          <span class="text-xl">âœ…</span>
          <span class="text-[10px] font-semibold leading-tight">Ibadah</span>
        </button>
    
      </div>
    </nav>

  </div>

</body>
</html>